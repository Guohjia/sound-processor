(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{tjUo:function(e,t,i){"use strict";function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return Math.pow(Math.E,-Math.pow(e-i,2)/(2*t*t))}function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}i.r(t),i.d(t,"SoundProcessor",function(){return n});var n=function(){function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var t=e.filterParams,i=void 0===t?{}:t,r=e.sampleRate,n=e.fftSize,s=e.endFrequency,a=e.startFrequency,h=e.outBandsQty;if(!n||!r||!h)throw new Error("need fftSize, sampleRate and outBandsQty");this.sampleRate=r,this.fftSize=n,this.bandsQty=Math.floor(n/2),this.outBandsQty=h,this.bandwidth=r/n,this.startFrequency=a||0,this.endFrequency=s||r,this.filterParams={mu:0,sigma:i.sigma||1,kernelRadius:i.kernelRadius||2},this.aWeights=[],this.bands=[],this.gKernel=[],this.historyLimit=5,this.history=[],this.initWeights(),this.initBands(),this.initGaussKernel(),this.process=this.process.bind(this)}var e,t,i;return e=o,(t=[{key:"initWeights",value:function(){for(var e,t,i=this.bandwidth,r=this.bandsQty,n=this.aWeights,s=0;s<r;s++)n.push((void 0,1.2588966*14884e4*(t=(e=s*i)*e)*t/((t+424.36)*Math.sqrt((t+11599.29)*(t+544496.41))*(t+14884e4))))}},{key:"initBands",value:function(){var e=this.endFrequency,t=this.startFrequency,i=this.outBandsQty,r=this.bands,n=Math.log2(e/t)/i;n=Math.pow(2,n);for(var s={lowerFrequency:Math.max(t,0),upperFrequency:0},a=0;a<i;a++){var h=s.lowerFrequency*n;s.upperFrequency=Math.min(h,e),r.push({lowerFrequency:s.lowerFrequency,upperFrequency:s.upperFrequency}),s.lowerFrequency=h}}},{key:"initGaussKernel",value:function(){for(var e=this.filterParams,t=this.gKernel,i=e.mu,r=e.sigma,n=e.kernelRadius,s=n,a=-s;a<1;a++)t.push(u(a,r,i));for(var h=s-1;-1<h;h--)t.push(t[h]);this.gKernelSum=t.reduce(function(e,t){return e+t}),this.kernelRadius=n,console.log(t)}},{key:"filter",value:function(e){for(var t=this.gKernel,i=this.gKernelSum,r=this.kernelRadius,n=0;n<e.length;n++){for(var s=0,a=n-r;a<n+r;a++){s+=(void 0!==e[a]?e[a]:0)*t[a-n+r]}e[n]=s/i}}},{key:"weighting",value:function(e){for(var t=this.aWeights,i=0;i<e.length;i++)void 0!==t[i]&&(e[i]=e[i]*t[i])}},{key:"generateSpectrums",value:function(e){for(var t=this.outBandsQty,i=this.bandwidth,r=this.bands,n=new Array(t),s=0;s<r.length;s++){for(var a=r[s],h=Math.floor(a.lowerFrequency/i),o=Math.min(Math.floor(a.upperFrequency/i),e.length-1),u=0,l=h;l<=o;l++)u+=e[l]*e[l];n[s]=Math.sqrt(u/(o+1-h))}return n}},{key:"timeAvg",value:function(e){var t=this.history,i=this.historyLimit;if(t.length<5)t.push(e.slice(0));else{t.pop(),t.unshift(e.slice(0));for(var r=0;r<e.length;r++){for(var n=0,s=0;s<i;s++)n+=t[s][r]/i;e[r]=n}}}},{key:"process",value:function(e){return this.timeAvg(e),this.filter(e),this.weighting(e),this.generateSpectrums(e)}}])&&r(e.prototype,t),i&&r(e,i),o}()}},[["tjUo",0]]]);