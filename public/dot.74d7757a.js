(window.webpackJsonp=window.webpackJsonp||[]).push([[2,3],{JRdx:function(e,t,i){"use strict";i.r(t);i("myKR");var n=i("nJx4"),a=document.querySelector("#audio");console.log("square");var r=new n.a(a,!0);window.addEventListener("click",function(){r.play()})},goMK:function(e,t,i){e.exports=i.p+"summer.fdd3aba5140cd0f10965772ae9da64b5.mp3"},myKR:function(e,t,i){},nJx4:function(e,t,i){"use strict";var s=i("tjUo");function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function n(e,t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.x=e,this.y=t,this.w=i,this.opacity=.3,this.smoother=.3}var e,t,i;return e=n,(t=[{key:"update",value:function(e){var t=this.smoother,i=this.lastF,n=.3+.7*(void 0!==i?i:e)/255,a=.3+.7*e/255;this.opacity=t*n+(1-t)*a,this.lastF=e}},{key:"draw",value:function(e){var t=this.opacity,i=this.x,n=this.y,a=this.w;e.fillStyle="rgba(".concat(212*t,", 60, 51, ").concat(t,")"),e.beginPath(),e.rect(i,n,a,a),e.closePath(),e.fill()}}])&&a(e.prototype,t),i&&a(e,i),n}();function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=function(){function a(e,t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.x=e,this.y=t,this.w=i,this.h=n,this.bottom=n+t,this.opacity=.3,this.smoother=0}var e,t,i;return e=a,(t=[{key:"update",value:function(e){var t=this.smoother,i=this.last,n=.05+.95*(void 0!==i?i:e)/255,a=.05+.95*e/255;this.opacity=t*n+(1-t)*a,this.last=e}},{key:"draw",value:function(e){var t=this.opacity,i=this.x,n=this.w,a=this.h,r=this.bottom-a*t;e.fillStyle="rgba(".concat(212*t,", 60, 51, ").concat(t,")"),e.beginPath(),e.rect(i,r,n,a*t),e.closePath(),e.fill()}}])&&n(e.prototype,t),i&&n(e,i),a}();function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function a(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var i=window.getComputedStyle(e),n=this.ratio=window.devicePixelRatio||1;e.width=parseFloat(i.width,10)*n,e.height=parseFloat(i.height,10)*n,this.ctx=e.getContext("2d"),this.ctx.fillStyle="rgba(255,255,255,0.5)",this.ctx.lineJoin="round",this.ctx.lineWidth=20,this.canvas=e,this.squares=[],this.draw=this.draw.bind(this),t?this.initSquares():this.initBars(),this.draw()}var e,t,i;return e=a,(t=[{key:"initBars",value:function(){for(var e=this.canvas,t=(e.width-440-5)/88,i=e.height-300,n=0;n<88;n++){var a=t*n+5*(n+1);this.squares.push(new r(a,i,t,300))}}},{key:"initSquares",value:function(){var e=40*this.ratio,t=this.canvas,i=t.width,n=t.height,a=Math.min(Math.min(i,n)/15,e),r=(i-13*a)/2,s=(n-13*a)/2,o=1.5*a*Math.floor(4.5)+r,u=1.5*a*Math.floor(4.5)+s;this.squares.push(new p(o,u,a));for(var h=1;h<=Math.floor(4.5);h++){for(var c=o-1.5*a*h,l=u-1.5*a*h,f=1;f<=2*h;f++)c+=1.5*a,this.squares.push(new p(c,l,a));for(var d=1;d<=2*h;d++)l+=1.5*a,this.squares.push(new p(c,l,a));for(var v=1;v<=2*h;v++)c-=1.5*a,this.squares.push(new p(c,l,a));for(var y=1;y<=2*h;y++)l-=1.5*a,this.squares.push(new p(c,l,a))}}},{key:"update",value:function(e){for(var t=this.squares,i=0;i<t.length;i++)void 0!==e[i]&&t[i].update(e[i]);this.draw()}},{key:"draw",value:function(){var e=this.ctx,t=this.squares,i=t.length;e.clearRect(0,0,this.canvas.width,this.canvas.height);for(var n=0;n<i;n++)t[n].draw(e)}}])&&o(e.prototype,t),i&&o(e,i),a}();i("goMK");function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=window.AudioContext||window.webkitAudioContext,l=function(){function r(e,t){var i=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),e){this.audio=e;var n=this.AC=new c,a=this.analyser=n.createAnalyser();a.fftSize=1024,n.createMediaElementSource(this.audio).connect(a),a.connect(n.destination),console.log(n,a),this.vc=new u(document.querySelector("#canvas"),t),this.soundProcessor=new s.SoundProcessor({filterParams:{sigma:1,kernelRadius:3},sampleRate:n.sampleRate,fftSize:1024,endFrequency:6e3,startFrequency:150,outBandsQty:88}),e.addEventListener("play",function(){i.onPlay()}),e.addEventListener("pause",function(){i.onPause()}),this.refreshFrame=this.refreshFrame.bind(this)}else console.error("need a audio dom")}var e,t,i;return e=r,(t=[{key:"onPlay",value:function(){console.log("resume",this.AC),this.paused=!1,this.refreshFrame()}},{key:"onPause",value:function(){this.paused=!0}},{key:"play",value:function(){var e=this;console.log("onPlay",this.audio.paused,this.AC.resume),this.audio&&this.audio.paused?this.AC.resume().then(function(){console.log("resume",e.AC),e.audio.play(),e.paused=!1,e.refreshFrame()}).catch(function(e){console.log("eeee",e)}):(this.audio.pause(),this.paused=!0)}},{key:"pause",value:function(){console.log("pause()"),this.audio&&!this.audio.paused&&(this.audio.pause(),this.paused=!0)}},{key:"refreshFrame",value:function(){var e=this.getFre();this.vc.update(e),this.paused||window.requestAnimationFrame(this.refreshFrame)}},{key:"getFre",value:function(){var e=this.analyser,t=this.soundProcessor,i=new Uint8Array(e.frequencyBinCount);return e.getByteFrequencyData(i),t.process(i)}}])&&h(e.prototype,t),i&&h(e,i),r}();t.a=l},tjUo:function(e,t,i){"use strict";function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return Math.pow(Math.E,-Math.pow(e-i,2)/(2*t*t))}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"SoundProcessor",function(){return a});var a=function(){function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);var t=e.filterParams,i=void 0===t?{}:t,n=e.sampleRate,a=e.fftSize,r=e.endFrequency,s=e.startFrequency,o=e.outBandsQty;if(!a||!n||!o)throw new Error("need fftSize, sampleRate and outBandsQty");this.sampleRate=n,this.fftSize=a,this.bandsQty=Math.floor(a/2),this.outBandsQty=o,this.bandwidth=n/a,this.startFrequency=s||0,this.endFrequency=r||n,this.filterParams={mu:0,sigma:i.sigma||1,kernelRadius:i.kernelRadius||2},this.aWeights=[],this.bands=[],this.gKernel=[],this.historyLimit=5,this.history=[],this.initWeights(),this.initBands(),this.initGaussKernel(),this.process=this.process.bind(this)}var e,t,i;return e=u,(t=[{key:"initWeights",value:function(){for(var e,t,i=this.bandwidth,n=this.bandsQty,a=this.aWeights,r=0;r<n;r++)a.push((void 0,1.2588966*14884e4*(t=(e=r*i)*e)*t/((t+424.36)*Math.sqrt((t+11599.29)*(t+544496.41))*(t+14884e4))))}},{key:"initBands",value:function(){var e=this.endFrequency,t=this.startFrequency,i=this.outBandsQty,n=this.bands,a=Math.log2(e/t)/i;a=Math.pow(2,a);for(var r={lowerFrequency:Math.max(t,0),upperFrequency:0},s=0;s<i;s++){var o=r.lowerFrequency*a;r.upperFrequency=Math.min(o,e),n.push({lowerFrequency:r.lowerFrequency,upperFrequency:r.upperFrequency}),r.lowerFrequency=o}}},{key:"initGaussKernel",value:function(){for(var e=this.filterParams,t=this.gKernel,i=e.mu,n=e.sigma,a=e.kernelRadius,r=a,s=-r;s<1;s++)t.push(h(s,n,i));for(var o=r-1;-1<o;o--)t.push(t[o]);this.gKernelSum=t.reduce(function(e,t){return e+t}),this.kernelRadius=a,console.log(t)}},{key:"filter",value:function(e){for(var t=this.gKernel,i=this.gKernelSum,n=this.kernelRadius,a=0;a<e.length;a++){for(var r=0,s=a-n;s<a+n;s++){r+=(void 0!==e[s]?e[s]:0)*t[s-a+n]}e[a]=r/i}}},{key:"weighting",value:function(e){for(var t=this.aWeights,i=0;i<e.length;i++)void 0!==t[i]&&(e[i]=e[i]*t[i])}},{key:"generateSpectrums",value:function(e){for(var t=this.outBandsQty,i=this.bandwidth,n=this.bands,a=new Array(t),r=0;r<n.length;r++){for(var s=n[r],o=Math.floor(s.lowerFrequency/i),u=Math.min(Math.floor(s.upperFrequency/i),e.length-1),h=0,c=o;c<=u;c++)h+=e[c]*e[c];a[r]=Math.sqrt(h/(u+1-o))}return a}},{key:"timeAvg",value:function(e){var t=this.history,i=this.historyLimit;if(t.length<5)t.push(e.slice(0));else{t.pop(),t.unshift(e.slice(0));for(var n=0;n<e.length;n++){for(var a=0,r=0;r<i;r++)a+=t[r][n]/i;e[n]=a}}}},{key:"process",value:function(e){return this.timeAvg(e),this.filter(e),this.weighting(e),this.generateSpectrums(e)}}])&&n(e.prototype,t),i&&n(e,i),u}()}},[["JRdx",0]]]);